"0",""
"0",""
"0","counts_table <- bind_rows("
"0","  county %>% "
"0","    select(level, name, date, cases) %>%"
"0","    mutate(name = fct_relabel(name, ~ifelse(. %in% counties, paste(., ""County""), .))),"
"0","  town %>%"
"0","    select(name = town, date, cases) %>%"
"0","    mutate(level = ""town"")"
"0",") %>%"
"0","  filter(date == date_range[2], cases >= reg_thresh, level != ""noid"") %>%"
"0","  mutate(level = as_factor(level) %>%"
"0","           fct_relevel(""state"", ""county"", ""town"", ""noid"")) %>%"
"0","  left_join(town_county, by = c(""name"" = ""town"")) %>%"
"0","  left_join(pops %>% select(-level), by = ""name"") %>%"
"0","  # replace_na(list(county = ""N/A"")) %>%"
"0","  mutate(`Cases per 10k residents` = round(cases / total_pop * 1e4, digits = 1)) %>%"
"0","  arrange(level, county, name) %>%"
"0","  select(county, name, cases, `Cases per 10k residents`) %>%"
"0","  rename_all(str_to_sentence)"
"0",""
"0","datatable(counts_table, "
"0","          options = list(searching = FALSE, rowGroup = list(dataSrc = 0, emptyDataGroup = ""State / counties"")),"
"0","          rownames = FALSE) %>%"
"0","  formatRound(""Cases"", digits = 0) %>%"
"0","  formatRound(4, digits = 1)"
